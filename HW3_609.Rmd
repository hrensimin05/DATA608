---
title: "HW_3"
author: "Dominika Markowska-Desvallons"
date: "10/3/2021"
output:
  pdf_document: default
  html_document: default
---
## Exercise 1
Write down Newton’s formula for finding the minimum of $$f(x) = (3x^{4} - 4x^{3}) / 12$$ in the range [-10, 10].Then, implement it in R.


#### Answer:
Findning derivatives

$$f'(x) = \frac{ 12x^{3} - 12x^{2} }{12} = x^{2}(x - 1) = x^{3} - x^{2}$$

$$f''(x) = 3x^{2} - 2x$$

Then the Newton’s formula to be: $$x_{k + 1} = x_{k} - \frac{x_k^{3} - x_k^{2}}{3x_k^{2} - 2x_k}$$

```{r}
fun <- function(x) {
 x - (x^3 - x^2) / (3 * x^2 - 2 * x)
}
fun1 <- function(y) {
  values <- c()
  for(i in 1:10) {
    if(i == 1){
      values[[i]] <- fun(y)
    }
    else{
      values[[i]] <- fun(values[[i - 1]])
    }
  }
  print(values)
}
fun1(2)

```
The minimum is 1 when multiple starting values are used


## Exercise 2
Explore optimize() in R and try to solve the previous problem.

#### Answer:
```{r}
fun2 <- function(x) {
  (3*x^4 - 4*x^3) / 12
}
x <- optimize(fun2, interval = c(-10,10), tol = 0.0001)
x

```
## Exercise 3
Use any optimization algorithm to find the minimum of $$f(x,y) = (x-1)^{2} + 100 (y - x^{2}) ^{2}$$ in the domain $$-10 \leq x,y \leq 10$$. Discuss any issues concerning the optimization process.

#### Answer:
$$x_{t + 1} = x_{t} - H^{-1}\bigtriangledown f(x,y)$$
$$x_{0} = \begin{bmatrix}x \\y \end{bmatrix} =\begin{bmatrix}0 \\0 \end{bmatrix}$$
$$\bigtriangledown f(x,y) = \begin{bmatrix}(x-1)^{2} \\100 (y - x^{2}) ^{2} \end{bmatrix}$$
Next step to find the Hessian matrix by finding second derivative

$$f_{xx} = 1200 x^{2} + 2 - 400y$$
$$f_{xy} = -400x$$
$$f_{yy} = 200$$

$$H = \bigtriangledown^2 f(x,y) = \begin{bmatrix}2 & -0 \\-0 & 200 \end{bmatrix}$$
 with $$x_{1} = x_{0} - H^{-1}\bigtriangledown f(x,y)$$
$$x_{1} = \begin{bmatrix}0 \\0 \end{bmatrix} - \begin{bmatrix}0.5 & 0 \\0 & 0.05 \end{bmatrix}\begin{bmatrix}1 \\0 \end{bmatrix}$$
$$x_{1} = \begin{bmatrix}-0.5 \\0 \end{bmatrix}$$
Moving forward the f(x,y) will  move toward into a single point as it goes through more values of t. So the most confusing was the multivariate function to move forward. 



Exercise 4
#### Answer:
Explore the optimr package for R and try to solve the previous problem.

```{r}
library(optimr)
```


```{r}
fun4 <- function(x, y){
  (x - 1)^2 + 100 * (y - x^2)^2
}
optimr(c(-10,10), fun4, method = "L-BFGS-B")


```